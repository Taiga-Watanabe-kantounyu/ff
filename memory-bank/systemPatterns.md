# System Patterns

## システムアーキテクチャ
- Node.jsを使用してサーバーサイドのロジックを実装。
- Google Cloud Pub/Subを使用して、非同期のメッセージングと通知を実現。
- モジュール分割によるコンポーネント化を採用し、機能ごとに独立したファイルを作成。

## キーテクニカルディシジョン
- Gmail APIを使用して、メールボックスの変更を監視。
- OAuth 2.0を使用して、ユーザー認証を実施。
- JSONファイルを使用して、お届け先マスタなどの設定情報を管理。

## デザインパターン
- 非同期プログラミングを活用し、効率的なAPI呼び出しを実現。
- トークンの管理と再利用を通じて、認証フローを最適化。
- データ変換パターンを使用して、Excelファイルのデータを適切な形式に整形。
- 冪等性（べきとうせい）パターンを実装し、同じファイルの重複処理を防止。
- アダプターパターンを使用して、異なるデータ形式（Excel形式とスプレッドシート形式）の間の変換を処理。
- テンプレートパターンを使用して、発注用ファイルの生成を実装。
- ファクトリーパターンを使用して、受注データから発注用ファイルを生成。
- リポジトリパターンを使用して、お届け先マスタの管理を実装。

## エラーハンドリング戦略
- 特殊文字や日本語を含むシート名の処理に関する問題を、固定値の使用で回避。
- try-catchブロックを使用して、API呼び出しのエラーを適切に処理。
- 詳細なログ出力を通じて、問題の診断と解決を容易に。
- お届け先マスタに存在しないデータの処理を、警告ログと空欄の使用で対応。
