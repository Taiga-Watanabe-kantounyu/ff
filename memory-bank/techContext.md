# Tech Context

## 使用技術
- **Node.js**: サーバーサイドのロジックを実装するためのJavaScriptランタイム。
- **Google Cloud Pub/Sub**: メッセージングと通知のための非同期通信プラットフォーム。
- **Gmail API**: メールボックスの変更を監視するためのAPI。
- **Google Sheets API**: スプレッドシートの読み書きを行うためのAPI。
- **xlsx**: Excelファイルの読み込みと処理を行うためのライブラリ。
- **JSON**: 設定情報やマスタデータを管理するためのデータフォーマット。

## 開発セットアップ
- Node.jsのバージョン: 22.13.0
- 必要なNPMパッケージ: `googleapis`, `@google-cloud/local-auth`, `xlsx`

## 技術的制約
- OAuth 2.0を使用した認証フローの実装。
- Pub/Subトピックへのアクセス権限の管理。
- Google Sheets APIでの日本語や特殊文字を含むシート名の処理に制限あり。
- Excelファイルの特定のフォーマット（C1セルに集荷日、B列以降に各項目）に依存。
- 発注用フォーマット（saito_irai.xlsx）の特定のセル位置（H3に本日日付、H4に集荷日、10行目からデータ）に依存。
- お届け先マスタに登録されていない配送先の場合、電話番号と住所が空欄になる制約。

## 依存関係
- `googleapis`: Google APIへのアクセスを提供。
- `@google-cloud/local-auth`: ローカルでの認証をサポート。
- `xlsx`: Excelファイルの読み込みと処理を行うためのライブラリ。
- `fs`: ファイルシステム操作のための標準ライブラリ。
- `path`: ファイルパス操作のための標準ライブラリ。
- `readline`: コマンドラインインターフェースを実装するための標準ライブラリ。
